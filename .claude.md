# ContinueWrite Project Context

## Project Overview

This is **ContinueWrite** - a fork of Continue.dev being transformed from a **coding AI assistant** into a **creative writing AI assistant** for authors, bloggers, and content creators.

### Current State: Continue.dev (Coding Assistant)
- VS Code extension for AI-powered code assistance
- Integrates with local LLMs via LM Studio, Ollama, etc.
- Features: code completion, debugging, refactoring, code generation
- Slash commands: `/commit`, `/review`, `/cmd`, etc.
- Context menu: "Fix Code", "Write Comments", "Optimize Code"

### Target State: ContinueWrite (Writing Assistant)
- VS Code extension for AI-powered creative writing assistance  
- Same LLM integrations (LM Studio, Ollama, etc.)
- Features: scene continuation, dialogue improvement, character development
- Slash commands: `/continue`, `/brainstorm`, `/character`, etc.
- Context menu: "Continue Scene", "Improve Dialogue", "Add Description"

## Architecture Overview

### Key Technologies
- **TypeScript** - Main language
- **React** - GUI frontend (`gui/` directory)
- **VS Code Extension API** - Extension framework
- **Node.js** - Backend/core logic
- **WebView** - Communication between extension and React GUI
- **LLM Integration** - OpenAI-compatible API calls to local models

### Directory Structure
```
continueWrite/
├── extensions/vscode/          # VS Code extension (main entry point)
│   ├── package.json           # Extension manifest (CRITICAL FILE)
│   ├── src/commands.ts        # Command definitions (CRITICAL FILE) 
│   └── src/extension.ts       # Extension activation
├── core/                      # Core business logic
│   ├── commands/slash/        # Slash command implementations
│   ├── config/                # Configuration handling
│   └── llm/                   # LLM provider integrations
├── gui/                       # React-based user interface
│   ├── src/components/        # UI components
│   ├── src/pages/            # Main application pages
│   └── package.json          # GUI dependencies
├── packages/                  # Shared packages
└── binary/                   # Binary distribution
```

### Critical Files for Transformation

#### 1. Extension Manifest
**`extensions/vscode/package.json`**
- Extension metadata (name, description, publisher)
- Command definitions and keybindings
- Context menu contributions
- Categories and keywords

#### 2. Command Handlers  
**`extensions/vscode/src/commands.ts`**
- Implementation of all VS Code commands
- Context menu action handlers
- LLM prompt templates for different actions

#### 3. Slash Commands
**`core/commands/slash/built-in-legacy/`**
- Built-in slash command implementations
- `/commit`, `/review` → `/continue`, `/brainstorm`, `/character`

#### 4. UI Components
**`gui/src/components/ConversationStarters/`**
- Default conversation starter prompts
- Empty state UI when no conversation exists

## Current Integration Points

### LM Studio Integration
- Uses OpenAI-compatible API endpoint (`http://localhost:1234/v1/`)
- Configured in `core/llm/llms/LMStudio.ts`
- Works with any LM Studio model (coding models → creative writing models)

### VS Code Integration
- Right-click context menu integration
- Command palette commands (`Ctrl+Shift+P`)
- Keyboard shortcuts (`Cmd/Ctrl+L` for chat, `Cmd/Ctrl+I` for edit)
- Status bar integration for model status

### WebView Communication
- Extension communicates with React GUI via WebView protocol
- Protocol defined in `extensions/vscode/src/webviewProtocol.ts`
- Messages flow: VS Code Extension ↔ Core ↔ GUI React App

## Transformation Strategy

### Phase 1: Identity & Branding
- Update `extensions/vscode/package.json` (name, description, keywords)
- Global find/replace command names (`continue.fixCode` → `continuewrite.improveWriting`)
- Update extension categories (remove "Programming Languages", add "Language Packs")

### Phase 2: Command Transformation  
- Modify `extensions/vscode/src/commands.ts` command handlers
- Replace coding prompts with writing prompts
- Update `streamInlineEdit` function with creative writing prompts

### Phase 3: Slash Commands
- Replace files in `core/commands/slash/built-in-legacy/`
- Remove: `commit.ts`, `review.ts`, `cmd.ts`
- Add: `continue-scene.ts`, `brainstorm.ts`, `character.ts`

### Phase 4: UI Updates
- Update conversation starters in `gui/src/components/ConversationStarters/`
- Modify empty chat body to show writing prompts
- Update any hardcoded text references to coding

### Phase 5: Configuration
- Update default config in `core/config/default.ts`
- Suggest creative writing models instead of coding models
- Update telemetry event names

## Development Workflow

### Build Commands
```bash
# Install all dependencies
npm install

# Build extension for testing
npm run esbuild

# Watch mode for development  
npm run esbuild-watch

# Package extension for distribution
npm run package
```

### Testing Workflow
1. **Build extension**: `npm run esbuild`
2. **Open in VS Code**: Press F5 or "Run Extension" in debug panel
3. **Test features**: Right-click menu, slash commands, LM Studio integration
4. **Iterate**: Make changes, rebuild, test again

### LM Studio Testing
1. **Start LM Studio** with a creative writing model (Claude, GPT-4, etc.)
2. **Configure ContinueWrite** to use `http://localhost:1234/v1/`
3. **Test commands**: Select text → right-click → "Continue Scene"

## Key Considerations

### Preserve Core Architecture
- **DO NOT** change the core LLM integration patterns
- **DO NOT** modify WebView communication protocols  
- **DO NOT** alter the extension activation lifecycle
- **FOCUS ON** prompts, commands, UI text, and slash commands

### Model Compatibility
- Ensure prompts work well with creative writing models
- Test with various model sizes (3B, 7B, 14B, 32B parameters)
- Optimize for local models (concise, clear prompts)

### User Experience
- Maintain familiar Continue.dev UX patterns
- Keep keyboard shortcuts consistent where possible
- Preserve chat-based interaction model
- Ensure right-click context menu is intuitive for writers

### Performance
- Keep prompt templates concise for faster inference
- Maintain efficient WebView communication
- Preserve existing caching and optimization patterns

## Success Metrics

### Functional Success
- ✅ Extension loads as "ContinueWrite - AI Writing Assistant"
- ✅ Right-click context menu shows writing commands (not coding commands)
- ✅ Slash commands `/continue`, `/brainstorm`, `/character` work
- ✅ LM Studio integration works with creative writing models
- ✅ Conversation starters show writing prompts

### Quality Success  
- ✅ Generated writing assistance is coherent and helpful
- ✅ Commands maintain author's voice and style
- ✅ Prompts produce appropriate creative content
- ✅ UI feels natural for writers (not developers)

## Common Debugging Areas

### Extension Won't Load
- Check `extensions/vscode/package.json` syntax
- Verify all command names are consistent
- Look for TypeScript compilation errors

### Commands Not Working
- Check command registration in `getCommandsMap()` function
- Verify command names match between `package.json` and `commands.ts`
- Check WebView protocol communication

### LM Studio Connection Issues
- Verify LM Studio server is running on `http://localhost:1234/v1/`
- Check network connectivity and firewall settings
- Test with curl/Postman first

### Prompts Producing Poor Output
- Test prompts directly with LM Studio chat interface
- Adjust prompt specificity and clarity
- Consider model capabilities and limitations

## Related Files

### Configuration Files
- `core/config/default.ts` - Default extension configuration
- `extensions/vscode/src/extension.ts` - Extension activation and setup

### UI Components
- `gui/src/App.tsx` - Main React application
- `gui/src/pages/gui/Chat.tsx` - Main chat interface
- `gui/src/components/mainInput/ContinueInputBox.tsx` - Input component

### LLM Integration
- `core/llm/llms/LMStudio.ts` - LM Studio provider implementation
- `core/llm/templates/` - Prompt templates for different tasks

## Getting Started

1. **Read the transformation plan**: `TRANSFORMATION_PLAN.md`
2. **Start with Phase 1**: Update `extensions/vscode/package.json`
3. **Test frequently**: Build and test after each major change
4. **Use LM Studio**: Test with actual creative writing models
5. **Follow the checklist**: Work through each phase systematically

---

**This project transforms Continue.dev's powerful local LLM infrastructure into a creative writing assistant, preserving all the technical excellence while shifting the focus from code to creative content.**
